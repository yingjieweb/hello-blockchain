# 区块链简介

## 区块链是什么？

顾名思义，区块链就是一条由区块组成的链条，只是相比普通的链表而言，它有一些特殊性。

以下是 [维基百科的解释](https://en.wikipedia.org/wiki/Blockchain)：

> 区块链是一种[分布式账本](https://en.wikipedia.org/wiki/Distributed_ledger)，其不断增长的[记录](<https://en.wikipedia.org/wiki/Record_(computer_science)>)列表（区块）通过[加密哈希](https://en.wikipedia.org/wiki/Cryptographic_hash_function)安全地链接在一起。每个区块包含前一个区块的加密哈希值、时间戳和交易数据（通常表示为[默克尔树](https://en.wikipedia.org/wiki/Merkle_tree)，其中数据节点用叶子节点表示）。由于每个区块都包含有关前一个区块的信息，它们实际上构成了一条链（类似于[链表](https://en.wikipedia.org/wiki/Linked_list)数据结构），每个新区块都链接到它之前的区块。因此，区块链交易具有很强的抗篡改性，因为一旦记录，任何给定区块中的数据都无法在不修改所有后续区块并获得网络共识的情况下进行追溯更改。

简单来说，区块链就是由一个个数据块，通过特殊的<u>哈希加密算法</u>链接在一起形成的一条链条；它是一种<u>分布式</u>的账本技术，能够在没有中央信任方的情况下记录交易与信息，同时提供可验证性与不可篡改性。

:::warning
大家可能经常听说比特币的相关信息，但需要注意的是，<u>区块链不是比特币</u>，比特币只是基于区块链技术实现的一种加密货币而已，以太坊之类的加密货币亦是如此。
:::

## 区块链的基本结构

<!-- TODO -->

为了更好的理解上述内容，我们先来看一下区块链的基本结构。

![An image](/bta/block-structure.png)

区块链中的每个区块都有<u>区块头</u>和<u>区块体</u>两部分组成；<u>区块头</u>中包含前一区块的哈希值、时间戳、随机数、Merkle 根、以及本区块的新哈希值；<u>区块体</u>中包含诸多交易数据，这些交易数据以 Merkle 树的形式进行汇总，得到 Merkle 根并放入区块头。

将区块头中的前一区块哈希、时间戳、版本号、Merkle 根等字段拼接成一个输入串，对输入串进行哈希运算，即可得到本区块的哈希（区块哈希）。本区块的哈希会被存储到下一个区块头中，并参与下一个区块的哈希运算，如此循环往复，环环相扣。

可以把区块链想成一串链环，每个环都带有“前一个环的指纹”和本环的交易指纹。只要有一个环的指纹被篡改，后续环的指纹就不再匹配，整条链因此暴露出不一致；这也就是区块链具有很强的抗篡改性的原因。

## 区块链的核心特征

### 1. 去中心化

在区块链中没有单一的中心实体来控制全部数据与交易，网络由众多独立节点共同维护与验证。

以支付宝为例，这是一个典型的中心化架构，信任与控制集中在一个实体及其网络之上，若系统出现故障，通常需要该公司内部的变更与干预来恢复。

在区块链中没有单一机构掌控所有数据，账本副本分布在网络中的众多节点，交易通过<u>共识规则</u>写入账本。即使单个节点异常，其他节点仍可维持系统运行与数据一致性。这对跨机构协作特别有价值，因为信任可以由算法与公开规则来实现，而非靠信任关系。

### 2.不可篡改性

一旦交易被确认并写入区块，就很难被后续修改或删除，因为要改变它需要同时修改之后的所有区块，并重新获得网络的共识，这几乎是不可能的。

如果某笔交易被记录在区块中并被后续区块覆盖，理论上需要同时控制大量节点并重新计算哈希，这在公开网络中几乎不现实，因此历史记录具有很高的可信度。

### 3. 透明性与可验证性

区块链的透明性意味着网络中的交易记录对所有参与者开放可查，任何人都可以独立核验数据的有效性。

你可以在区块浏览器中看到交易的发送地址、接收地址、金额与时间戳，从而验证交易确实发生且符合规则。

### 4. 共识机制

共识机制是一组规则，确保分布在全球各地的节点就<u>"哪些交易被写入区块"</u>以及<u>"区块序列的顺序"</u>达成一致。

- **"哪些交易被写入区块"**：网络中的节点需要一致决定哪些交易是有效的、应该被记录到区块链上。比如，如果 Alice 向 Bob 转账 10 个币，所有节点都应该认可这笔交易，而不是有些节点认为有效、有些认为无效。

- **"区块序列的顺序"**：节点需要就区块的先后顺序达成一致。比如，区块 A 在区块 B 之前，还是之后？这很重要，因为顺序不同可能导致交易结果不同，比如双花攻击（同一笔钱花两次）。

即使存在恶意节点试图破坏系统，或者网络被分割成多个部分，共识机制仍然能够：

- 让诚实节点就账本状态达成一致
- 防止恶意节点篡改历史记录
- 在网络恢复后，自动解决分区期间的不一致问题

这就是区块链能够在去中心化、不信任环境中安全运行的核心保障。

<!-- 常见共识算法的对比：

| 共识机制 | 原理与要点 | 优点 | 缺点/权衡 |
|---------|-----------|------|----------|
| **工作量证明（PoW）** | 节点通过算力竞争记账权，胜出者打包新区块并获得奖励 | 抗攻击性强，去中心化程度高，安全性直观可验证 | 能源消耗高、确认时间相对较长、对算力集中风险敏感 |
| **权益证明（PoS）** | 持有并锁定一定数量货币的节点参与记账，通过权益与投票机制选出记账方 | 能耗大幅降低、理论上确认更快、可扩展性更好 | 对准入门槛和治理设计敏感，可能出现"富者越富"的风险，需要治理机制防止集中化 |
| **PBFT（实用拜占庭容错）** | 注重快速最终性，通常在许可链中使用 | 适合小型、信任边界清晰的网络 | 需要已知且相对固定的节点集合，不适合大规模公开网络 |

- **比特币（Bitcoin）**：使用 **PoW**（工作量证明），这是第一个成功应用 PoW 的区块链，至今仍在使用。

- **以太坊（Ethereum）**：

  - 2022 年 9 月之前：使用 **PoW**
  - 2022 年 9 月之后（The Merge 升级）：切换到 **PoS**（权益证明），大幅降低了能耗

- **其他主流区块链**：
  - **Cardano、Polkadot、Solana** 等：使用 **PoS** 或其变体
  - **Hyperledger Fabric**：使用 **PBFT** 或其变体（许可链）
  - **一些企业区块链**：通常使用 **PBFT** 或类似的拜占庭容错算法

可以看到，**PoS 正在成为主流趋势**，因为它解决了 PoW 的能耗问题，同时保持了较好的安全性和去中心化程度。 -->
